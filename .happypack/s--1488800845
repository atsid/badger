'use strict';

var React = require('react');
var Login = require('./Login');
var MyProjects = require('./MyProjects');

var Dashboard = React.createClass({
  displayName: 'Dashboard',

  contextTypes: {
    stores: React.PropTypes.object.isRequired
  },

  getInitialState: function getInitialState() {
    return {};
  },
  componentDidMount: function componentDidMount() {
    return this.getStateFromStore();
  },
  getStateFromStore: function getStateFromStore() {
    var _this = this;

    this.setState({ loading: true });
    this.context.stores.users.getCurrentUser().then(function (user) {
      return _this.setState({ user: user, loading: false });
    }).catch(function () {
      return _this.setState({ loading: false });
    });
  },
  render: function render() {
    var result = null;
    if (this.state.user) {
      result = React.createElement(MyProjects, null);
    } else {
      result = React.createElement(Login, null);
    }
    return result;
  }
});

module.exports = Dashboard;